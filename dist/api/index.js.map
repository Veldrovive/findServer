{"version":3,"sources":["../../src/api/index.js"],"names":["config","db","family","api","use","get","req","res","json","version","send","params","interTime","data","deviceList","err","success","getProb","devices","returnDevices","returnDevice","name","getDevices"],"mappings":";;;;;;AAAA;;AACA;;AACA;;;;AACA;;;;;;;;kBAEe,gBAAoB;AAAA,KAAjBA,MAAiB,QAAjBA,MAAiB;AAAA,KAATC,EAAS,QAATA,EAAS;;AAClC,KAAIC,SAAS,wBAAmBF,OAAOE,MAA1B,EAAkC,KAAlC,CAAb;AACA,KAAIC,MAAM,sBAAV;;AAEA;AACAA,KAAIC,GAAJ,CAAQ,SAAR,EAAmB,sBAAO,EAAEJ,cAAF,EAAUC,MAAV,EAAP,CAAnB;;AAEA;AACAE,KAAIE,GAAJ,CAAQ,GAAR,EAAa,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC1BA,MAAIC,IAAJ,CAAS,EAAEC,yBAAF,EAAT;AACA,EAFD;;AAIAN,KAAIE,GAAJ,CAAQ,OAAR,EAAiB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAC9BA,MAAIG,IAAJ,CAAS,MAAT;AACA,EAFD;;AAIAP,KAAIE,GAAJ,CAAQ,gCAAR;AAAA,sEAA0C,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AACzCL,gBAAS,wBAAmBI,IAAIK,MAAJ,CAAWT,MAA9B,EAAsCI,IAAIK,MAAJ,CAAWC,SAAjD,CAAT;AACAL,WAAIG,IAAJ,CAAS,UAAT;;AAFyC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA1C;;AAAA;AAAA;AAAA;AAAA;;AAKAP,KAAIE,GAAJ,CAAQ,UAAR;AAAA,sEAAoB,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AACnBA,WAAIC,IAAJ,CAAS,EAACK,MAAMX,OAAOY,UAAd,EAA0BC,KAAK,EAA/B,EAAmCC,SAAS,IAA5C,EAAT;;AADmB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAApB;;AAAA;AAAA;AAAA;AAAA;;AAIAb,KAAIE,GAAJ,CAAQ,WAAR;AAAA,sEAAqB,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AACpBL,cAAOe,OAAP;AACAV,WAAIG,IAAJ,CAAS,UAAT;;AAFoB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAArB;;AAAA;AAAA;AAAA;AAAA;;AAKAP,KAAIE,GAAJ,CAAQ,aAAR;AAAA,sEAAuB,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AACtBA,WAAIC,IAAJ,CAAS,EAACU,SAAShB,OAAOiB,aAAP,EAAV,EAAkCH,SAAS,IAA3C,EAAT;;AADsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAvB;;AAAA;AAAA;AAAA;AAAA;;AAIAb,KAAIE,GAAJ,CAAQ,eAAR;AAAA,sEAAyB,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,sBACxBA,GADwB;AAAA;AAAA,cACTL,OAAOkB,YAAP,CAAoBd,IAAIK,MAAJ,CAAWU,IAA/B,CADS;;AAAA;AAAA;;AAAA,oBACpBb,IADoB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAzB;;AAAA;AAAA;AAAA;AAAA;;AAIAL,KAAIE,GAAJ,CAAQ,gBAAR;AAAA,sEAA0B,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,sBACzBA,GADyB;AAAA;AAAA,cACVL,OAAOoB,UAAP,EADU;;AAAA;AAAA;;AAAA,oBACrBd,IADqB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAA1B;;AAAA;AAAA;AAAA;AAAA;;AAIA,QAAOL,GAAP;AACA,C","file":"index.js","sourcesContent":["import { version } from '../../package.json';\nimport { Router } from 'express';\nimport familyIterator from './functions.js'\nimport facets from './facets';\n\nexport default ({ config, db }) => {\n\tlet family = new familyIterator(config.family, 10000);\n\tlet api = Router();\n\n\t// mount the facets resource\n\tapi.use('/facets', facets({ config, db }));\n\n\t// perhaps expose some API metadata at the root\n\tapi.get('/', (req, res) => {\n\t\tres.json({ version });\n\t});\n\n\tapi.get('/ping', (req, res) => {\n\t\tres.send(\"pong\");\n\t})\n\n\tapi.get(\"/createList/:family/:interTime\", async (req, res) => {\n\t\tfamily = new familyIterator(req.params.family, req.params.interTime);\n\t\tres.send(\"Creating\");\n\t})\n\n\tapi.get(\"/getInfo\", async (req, res) => {\n\t\tres.json({data: family.deviceList, err: '', success: true});\n\t})\n\n\tapi.get(\"/getProbs\", async (req, res) => {\n\t\tfamily.getProb();\n\t\tres.send(\"Starting\");\n\t})\n\n\tapi.get(\"/deviceList\", async (req, res) => {\n\t\tres.json({devices: family.returnDevices(), success: true});\n\t})\n\n\tapi.get(\"/device/:name\", async (req, res) => {\n\t\tres.json(await family.returnDevice(req.params.name));\n\t})\n\n\tapi.get(\"/updateDevices\", async (req, res) => {\n\t\tres.json(await family.getDevices());\n\t})\n\n\treturn api;\n}\n"]}